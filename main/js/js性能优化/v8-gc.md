### v8垃圾回收策略

1. 采用分代回收思想
2. 内存分为新生代、老生代
3. 针对不同对象采用不同算法

#### v8如何回收新生代对象

##### v8内存分配

1. v8内存空间一分为二
2. 小空间用于存储新生代对象（64位 32m ｜32位 16m）
3. 新生代指的是存活时间较短的对象

##### 新生代对象回收机制

1. 回收过程采用复制算法 + 标记整理
2. 新生代内存区分为两个等大小的空间，使用空间From，空闲空间To
3. 活动对象存储于From空间
4. 标记整理后将活动对象拷贝至To，from空间释放掉
5. From和To交换空间完成释放；from复制给to，from释放掉，to空间变为from，from变为to

回收细节说明

* 拷贝过程中可能出现晋升；经过一轮gc后还存在
* 晋升就是将新生代对象移动至老生代
* To空间shiyonglb超过25%；移至老生代

#### v8如何回收老生代对象

##### 老生代对象说明

1. 老生代就是指存活时间较长的对象；在全局下定义的或闭包内部保存的
2. 62位分配1.4g，32位分配700m

##### 老生代回收机制

1. 主要采用标记清除、标记整理、增量标记
2. 使用标记清除完成垃圾空间的回收
3. 采用标记整理进行空间优化；
   1. 新生代往老生代移动的时候且老生代存储空间不足以存放新生代移过来的对象
   2. 这种情况下会进行标记整理。老生代主要还是采用标记清除
4. 采用增量标记进行效率提升

#### 两种回收方式对比

1. 新生代区域垃圾回收使用空间换时间
2. 老生代垃圾回收区域不适合复制算法；
   1. 数据较多
   2. 老生代较大，复制浪费的内存较多

增量标记如何优化垃圾回收

* 程序执行和gc交替操作，交替进行标记；拆分可以减少程序执行的停顿时间